---
name: 麦当劳优惠券助手
description: 麦当劳优惠券助手skill。当用户需要配置麦当劳MCP服务器、自动领取优惠券、查看优惠券信息时使用此skill。包括：1) 指导用户获取MCP token（访问 https://open.mcd.cn/mcp/doc），2) 配置opencode的麦当劳MCP服务器，3) 自动领取所有可用优惠券，4) 分析优惠券信息并生成Markdown表格，5) 提供优惠券使用建议。
---

# 麦当劳优惠券助手

## 概述

此skill帮助用户在opencode环境中通过自然语言直接查询麦当劳MCP工具，自动领取优惠券，并分析优惠券信息生成详细的Markdown表格。优化版支持直接使用MCP工具，无需脚本调用。

**重要提示**：使用本skill需要麦当劳MCP token。如果用户没有token，请引导用户访问官方文档获取：**https://open.mcd.cn/mcp/doc**

## 核心流程

### 1. 检查MCP配置状态
- 检查用户主目录 `~/.config/opencode/opencode.json` 是否存在
- 检查是否已配置麦当劳MCP服务器
- 如果已配置，跳过配置步骤直接进入优惠券管理

### 2. 配置麦当劳MCP服务器
如果未配置或用户需要重新配置：

#### 2.1 获取MCP Token
如果用户不知道如何获取token或没有token，请引导用户访问：
**https://open.mcd.cn/mcp/doc**

在这个官方文档页面，用户可以：
1. 了解麦当劳MCP服务的基本信息
2. 查看如何注册和获取API访问权限
3. 获取个人MCP token
4. 查看API使用限制和注意事项

#### 2.2 配置步骤
1. 创建opencode配置目录：`~/.config/opencode/`
2. 创建或更新 `opencode.json` 文件
3. 使用以下配置模板：
```json
{
  "$schema": "https://opencode.ai/config.json",
  "mcp": {
    "mcd-mcp": {
      "type": "remote",
      "url": "https://mcp.mcd.cn/mcp-servers/mcd-mcp",
      "headers": {
        "Authorization": "Bearer YOUR_MCP_TOKEN"
      },
      "enabled": true
    }
  }
}
```
4. 向用户询问MCP token并替换 `YOUR_MCP_TOKEN`
   - 如果用户有token：直接输入
   - 如果用户没有token：提供上述链接并暂停配置
5. 验证配置：直接调用MCP API检查连接状态

### 3. 自然语言查询MCP工具
配置成功后，直接通过自然语言调用MCP工具：
1. **获取时间信息**：查询当前服务器时间
2. **自动领取优惠券**：一键领取所有可用优惠券
3. **查询我的优惠券**：获取用户已拥有的优惠券列表
4. **查询可领取优惠券**：查看当前可领取的优惠券
5. **查询活动日历**：获取麦当劳营销活动日历

### 4. 分析优惠券信息并生成Markdown表格
使用MCP工具获取数据后：
1. **今天可用的优惠券** - 可购买物品、使用条件、有效期
2. **未来可用的优惠券** - 可购买物品、生效日期、使用条件
3. **最佳组合建议** - 基于优惠券详情推荐的最佳组合使用方案
4. **今日到期提醒** - 标记今日到期的优惠券
5. **活动日历重点** - 当前正在进行的活动

## MCP工具使用说明

### 可用工具
- `mcd-mcp_now-time-info`: 获取当前时间信息
- `mcd-mcp_auto-bind-coupons`: 自动领取所有可用优惠券
- `mcd-mcp_my-coupons`: 查询用户已拥有的优惠券（支持分页）
- `mcd-mcp_available-coupons`: 查询当前可领取的优惠券列表
- `mcd-mcp_campaign-calender`: 查询麦当劳营销活动日历

### 自然语言查询示例
- "获取当前时间"
- "自动领取麦当劳优惠券"
- "查看我的优惠券"
- "有哪些优惠券可以领取"
- "查看麦当劳活动日历"

## 输出要求

### Markdown表格格式
```markdown
## 麦当劳优惠券使用指南

### 1. 今天可用的优惠券
| 优惠券名称 | 可购买物品 | 使用条件 | 有效期 | 状态 |
|------------|------------|----------|--------|------|
| ... | ... | ... | ... | ... |

### 2. 未来可用的优惠券
| 优惠券名称 | 可购买物品 | 生效日期 | 使用条件 | 备注 |
|------------|------------|----------|----------|------|
| ... | ... | ... | ... | ... |

### 3. 最佳组合使用建议
| 组合方案 | 包含优惠券 | 预计节省 | 使用策略 | 推荐度 |
|----------|------------|----------|----------|--------|
| ... | ... | ... | ... | ... |

### 4. 今日到期提醒
1. **优惠券名称** - 到期时间，使用建议

### 5. 活动日历重点
- **今日活动**：活动标题和简要说明
```

## 错误处理

1. **配置失败**: 检查网络连接、token有效性、目录权限
   - 如果用户没有token，请访问：**https://open.mcd.cn/mcp/doc** 获取
2. **MCP连接失败**: 验证URL和headers配置，检查token是否有效
   - 无效token：重新获取token，访问：**https://open.mcd.cn/mcp/doc**
   - 过期token：重新申请新token
3. **优惠券领取失败**: 检查用户账户状态、活动时间，可能没有可领取的优惠券
4. **数据获取失败**: 重试机制、提供错误信息
5. **Token获取失败**: 引导用户访问官方文档获取帮助

## 最佳实践

1. 每次运行先检查现有配置，避免重复配置
2. 保存用户token时确保安全性
3. 提供清晰的进度反馈
4. 表格数据要准确、易读
5. 组合建议要基于实际优惠券详情分析
6. 直接使用curl调用MCP API，避免依赖opencode命令执行
7. 解析JSON响应，提取有用信息
8. 处理API错误响应（如403错误）

## 工作流程优化

### 新流程（自然语言查询）
1. 用户请求帮助
2. 直接调用MCP工具
3. 获取格式化结果
4. 分析数据生成报告
5. 提供使用建议

## 优势对比

| 特性 | 脚本调用 | 自然语言查询 |
|------|----------|--------------|
| 配置复杂度 | 高（需要Python环境） | 低（直接使用） |
| 响应速度 | 慢（多步骤） | 快（直接调用） |
| 错误处理 | 复杂（需要解析错误） | 简单（直接显示） |
| 用户体验 | 差（需要命令行操作） | 好（自然语言交互） |
| 维护成本 | 高（需要维护脚本） | 低（工具自动更新） |

## 使用场景

### 场景1：首次使用
1. 用户请求配置麦当劳MCP
2. 询问并保存token
3. 验证配置
4. 自动领取优惠券
5. 生成分析报告

### 场景2：日常查询
1. 用户询问优惠券信息
2. 直接调用MCP工具
3. 获取最新数据
4. 提供分析建议

### 场景3：活动提醒
1. 查询活动日历
2. 识别重要活动
3. 提醒用户参与
4. 提供参与建议

## 示例对话

**用户**: 帮我配置麦当劳MCP并查看优惠券

**助手**:
1. 检查配置状态
2. 询问token并配置
   - 如果用户有token：直接配置
   - 如果用户没有token：提供链接 **https://open.mcd.cn/mcp/doc** 获取token
3. 自动领取优惠券
4. 查询我的优惠券
5. 查询活动日历
6. 生成分析报告

**用户**: 我没有token，怎么获取？

**助手**:
请访问麦当劳MCP官方文档获取token：**https://open.mcd.cn/mcp/doc**
在这个页面您可以：
1. 了解麦当劳MCP服务
2. 注册获取API访问权限
3. 获取个人MCP token
4. 查看使用说明和限制

**用户**: 今天有什么优惠券可以用？

**助手**:
1. 查询当前时间
2. 查询我的优惠券
3. 筛选今日可用优惠券
4. 提供使用建议

**用户**: 有什么新活动吗？

**助手**:
1. 查询活动日历
2. 提取今日和近期活动
3. 提供活动参与建议

## 注意事项

1. **Token安全性**: 确保token不泄露，建议定期更新
2. **使用频率**: 避免频繁调用，合理使用缓存
3. **数据时效**: 优惠券数据实时变化，每次查询都是最新
4. **错误处理**: 友好的错误提示，帮助用户解决问题
5. **用户体验**: 简洁明了的输出，便于用户理解和使用